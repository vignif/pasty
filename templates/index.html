<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pasty</title>
    <link rel="stylesheet" href="{{ url_for('static', path='style.css') }}">
</head>
<body>
    <div class="container">
        <div class="logo">
            <a href="/">
                <img src="{{ url_for('static', path='logo.png') }}" alt="Pasty Logo">
            </a>
        </div>
        <p>Pasty is an online text storage application. It works as an online clipboard to store and retrieve text. All text is stored in a SQLite database. 
            The text is deleted after a configurable period of time.
            Store up to 1000 characters. <a href="https://github.com/vignif/pasty">Source code available</a>.
        </p>
        <p>Do not store sensitive information.</p>
        <!-- Tab Navigation -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab(event, 'save-tab')">Save Text</button>
            <button class="tab" onclick="switchTab(event, 'retrieve-tab')">Retrieve Text</button>
        </div>

        <!-- Tab Content for Saving Text -->
        <div id="save-tab" class="tab-content active">
            <form action="/submit" method="post">
                <textarea name="content" id="content" placeholder="Paste your text here..." required maxlength="1000" oninput="updateCount()"></textarea>
                <div class="char-count"><span id="charCount">0</span>/1000 characters</div>
                <button type="submit">Save</button>
            </form>

            {% if id %}
            <div class="results">
                <h2>Text Saved</h2>
                <p><strong>ID:</strong> {{ id }}</p>
                <p><strong>Text:</strong> {{ content }}</p>
            </div>
            {% endif %}
        </div>

        <!-- Tab Content for Retrieving Text -->
        <div id="retrieve-tab" class="tab-content">
            <form action="/retrieve" method="get">
                <input type="text" name="lookup_id" placeholder="Enter your ID" required>
                <button type="submit">Retrieve</button>
            </form>

        </div>
        {% if retrieved_content %}
        <div class="results">
            <h2>Retrieved Text</h2>
            <p><strong>Content:</strong> {{ retrieved_content }}</p>
        </div>
        {% elif error %}
        <div class="results error">
            <p>{{ error }}</p>
        </div>
        {% endif %}
    </div>

    <script>
        function updateCount() {
            const count = document.getElementById('content').value.length;
            document.getElementById('charCount').innerText = count;
        }

        function switchTab(event, tabId) {
            // Remove 'active' class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Add 'active' class to the clicked tab
            event.target.classList.add('active');

            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // Show the clicked tab's content
            document.getElementById(tabId).classList.add('active');
        }

        // Auto-switch to retrieve tab if there's a retrieval-related response
        window.onload = function() {
            if (retrievedContent || error) {
                switchTab(event, 'retrieve-tab');
            }
        };
    </script>
    <footer class="footer">
        <p>
            Pasty - A simple text storage application powered by
            <a href="https://fastapi.tiangolo.com/">FastAPI</a> and
            <a href="https://www.sqlite.org/index.html">SQLite</a>.
            <br>
            Made with ðŸ«€ in ðŸ‡®ðŸ‡¹ by <a href="https://github.com/vignif">Francesco Vigni</a>
            in 2025.
        </p>
    </footer>

</body>
</html>
